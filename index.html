<!DOCTYPE html>
<html>
<head>
  <title>Emergency Hand Sign Recognition</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest"></script>
</head>
<body style="text-align:center">

<h2>Emergency Hand Sign Recognition</h2>

<button onclick="start()">Start Camera</button>

<p id="result">Waiting...</p>

<video id="webcam" autoplay playsinline width="224" height="224"></video>

<script>

const URL = "./";

let model, webcam;

async function start() {
  model = await tmImage.load(URL + "model.json", URL + "metadata.json");

  webcam = new tmImage.Webcam(224,224,true);
  await webcam.setup();
  await webcam.play();

  document.getElementById("webcam").srcObject = webcam.webcam;

  window.requestAnimationFrame(loop);
}

async function loop() {
  const prediction = await model.predict(webcam.canvas);

  let best = prediction.reduce((a,b)=>a.probability>b.probability?a:b);

  document.getElementById("result").innerText =
      best.className + " (" + (best.probability*100).toFixed(1) + "%)";

  window.requestAnimationFrame(loop);
}
</script>

</body>
</html>
